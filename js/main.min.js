let dateInputs = document.querySelectorAll(".date-input")
dateInputs.forEach(el=>{
    new AirDatepicker(el, {
        locale: localeRu,
        // inline: true,
        // isMobile: true,
        autoClose: true,
        // selectedDates: [new Date()],
        onSelect: () => {
            $(".date-input").addClass("input-active")
        }
    })
})


$(".inout__date .date-input").selectedDates = [new Date()];

$(".form-group input").each(function(index, el) {
    InputIsFilled($(el))
});

$(".form-group textarea").each(function(index, el) {
    InputIsFilled($(el))
});


$(".form-group select").each(function(index, el) {
    InputIsFilled($(el))
});

$(".form-group input").change(function() {
    InputIsFilled($(this))
})

$(".form-group textarea").change(function() {
    InputIsFilled($(this))
})

$(".form-group select").change(function() {
    InputIsFilled($(this))
})


function InputIsFilled(el) {
    if ($(el).val()) {
        $(el).addClass("input-active")
    } else {
        $(el).removeClass("input-active")
    }
}


$(".tab").click(function() {
    let parentBlock = $(this).parents(".tabs-parent")
    let tabId = $(this).attr("data-tab")
    console.log(parentBlock)
    $(parentBlock).find(".tab").removeClass("_active")
    $(this).addClass("_active")
    $(parentBlock).find(".tab-content").removeClass("_active")
    $(parentBlock).find(`.tab-${tabId}`).addClass("_active")
})


$(".rating__item").click(function() {
    let ratingItem = parseInt($(this).attr("data-rating-value"))
    $(this).parent(".rating").attr("data-total-rating", ratingItem)
})

function cartCalc(){
    $('.cartcalc .ccalc-minus').click(function(){
        let a = $(this).closest('.cartcalc').find('input').val();
        if(a>1){
            let b = +a-1;
            $(this).closest('.cartcalc').find('input').val(b);
        }else{
            $(this).closest('.cartcalc').find('input').val(a);
        }
    });
    $('.cartcalc .ccalc-plus').click(function(){
        let a = $(this).closest('.cartcalc').find('input').val();
        let b = +a+1;
        $(this).closest('.cartcalc').find('input').val(b);
    });
}

cartCalc()

$(".header__lk").hover(onIn, onOut);
$(".nav__item").hover(onIn, onOut);

function onIn() {
    if (window.innerWidth > 992) {
        let el = $(this)
        setTimeout(function() {
            if (el.is(':hover')) {
                el.addClass("_active")
            }
        }, 200);
    }
}

function onOut() {
    if (window.innerWidth > 992) {
        $(this).removeClass("_active")
    }
}


if (window.innerWidth <= 992){
    $(".header__lk-show").click(function () {
        $(".header__lk-hidden").fadeToggle()
    })


    $(document).mouseup(function(e) {
        var div = $('.header__lk');
        if (!div.is(e.target) && div.has(e.target).length === 0) {
            $(".header__lk-hidden").fadeOut()
        }
    });
}

fixHeader()
$(window).scroll(function() {
    fixHeader()
})

function fixHeader() {
    if ($(window).scrollTop() > 50) {
        $(".header--index").addClass("header--fix")
    } else {
        $(".header--index").removeClass("header--fix")
    }
}

function advantageSlider() {
    var swiper = new Swiper('.advantages .swiper-container', {
        slidesPerView: "auto",
        spaceBetween: 29,
        breakpoints:{
            320:{
                slidesPerView: "auto",
            },
            1200:{
                slidesPerView: 4,
            },
        }
    })
}

function companiesSlider() {
    var swiper = new Swiper('.companies .swiper-container', {
        slidesPerView: "auto",
        spaceBetween: 51,
    })
}

function historySlider() {
    var swiper2 = new Swiper(".history__content .swiper-container", {
        spaceBetween: 1000,
        allowTouchMove: false,
        thumbs: {
            swiper: swiper,
        },
    });
    var swiper = new Swiper('.history__slider .swiper-container', {
        slidesPerView: 1,
        spaceBetween: 40,
        // slideToClickedSlide: true,
        watchSlidesProgress: true,
        on: {
            slideChangeTransitionEnd: function () {
                let num = +$(".history__slider .swiper-slide-active").attr("aria-label").slice(0, -3)
                swiper2.slideTo(num-1)
            },
        },
        breakpoints:{
            320:{
                spaceBetween: 13,
            },
            992:{
                spaceBetween: 40,
            },
        }
    })

    $(".history__slider .swiper-slide").click(function () {
        let num = +$(this).attr("aria-label").slice(0, -3)
        setActiveSlide(num)
    })

    function setActiveSlide(num) {
        swiper.slideTo(num-1)
        swiper2.slideTo(num-1)
    }
}

function workersSlider() {
    var swiper = new Swiper('.workers .swiper-container', {
        slidesPerView: "auto",
        spaceBetween: 24,
        breakpoints:{
            320:{
                slidesPerView: "auto",
            },
            1200:{
                slidesPerView: 4,
            },
        }
    })
}

function vacancySlider() {
    var swiper = new Swiper('.vacancy-collection .swiper-container', {
        slidesPerView: "auto",
        spaceBetween: 29,
        breakpoints:{
            320:{
                slidesPerView: "auto",
            },
            1200:{
                slidesPerView: 3,
            },
        }
    })
}

function aboutSlider() {
    var swiper = new Swiper('.about-gallery .swiper-container', {
        slidesPerView: 1,
        spaceBetween: 20,
        pagination: {
            el: '.about-gallery .swiper-pagination',
            type: 'fraction',
        },
    })
}


function gallerySlider() {
    var swiper = new Swiper('.catalog-gallery .swiper-container', {
        slidesPerView: 1,
        spaceBetween: 20,
        pagination: {
            el: '.catalog-gallery .swiper-pagination',
            type: 'fraction',
        },
    })
}

function reviewsSlider() {
    var swiper = new Swiper('.review__items .swiper-container', {
        slidesPerView: "auto",
        spaceBetween: 22,
    })
}

function whoSlider() {
    var swiper = new Swiper('.for-who .swiper-container', {
        slidesPerView: "auto",
        spaceBetween: 34,
        navigation: {
            nextEl: '.for-who .swiper-button-next',
            prevEl: '.for-who .swiper-button-prev',
        },
        breakpoints:{
            320:{
                slidesPerView: "auto",
                spaceBetween: 22,
            },
            1200:{
                slidesPerView: 3,
                spaceBetween: 34,
            },
        }
    })
}

function howSlider() {
    var swiper = new Swiper('.how .swiper-container', {
        slidesPerView: "auto",
        spaceBetween: 30,
        breakpoints:{
            320:{
                slidesPerView: "auto",
            },
            1200:{
                slidesPerView: 4,
            },
        }
    })
}

advantageSlider()
companiesSlider()
historySlider()
workersSlider()
vacancySlider()
aboutSlider()
gallerySlider()
reviewsSlider()
whoSlider()
howSlider()

if(window.innerWidth>992){
    $(".apart-card").mouseover(function () {
        $(this).addClass("_open")
        $(this).find(".apart-card__hidden").slideDown()
    })
    $(".apart-card").mouseleave(function () {
        $(this).removeClass("_open")
        $(this).find(".apart-card__hidden").slideUp()
    })
} else{
    $(".apart-card__toggle").click(function () {
        $(this).parents(".apart-card").toggleClass("_open")
        $(this).parents(".apart-card").find(".apart-card__hidden").slideToggle()
    })
}

$(".fav-btn").click(function () {
    $(this).toggleClass("_active")
})

$(".search-detail__toggle").click(function () {
    $(".search-detail__hidden").slideToggle()
    $(".search-detail").toggleClass("_open")
})


// $(".catalog .main__btn").click(function (e) {
//     e.preventDefault()
//     let comeTopApart = $("#comeTopApart")
//     let leaveFromApart = $("#leaveFromApart")
//     let personInRoom = $("#personInRoom")
//
//     let comeTopApartIsValid = checkInputFilled($(comeTopApart))
//     let leaveFromApartIsValid = checkInputFilled($(leaveFromApart))
//     let personInRoomIsValid = checkInputFilled($(personInRoom))
//
//     if(comeTopApartIsValid && leaveFromApartIsValid && personInRoomIsValid){
//         $(".catalog__type").slideDown()
//     }
// })
//
//
// function checkInputFilled(input) {
//     if($(input).val() !== ""){
//         setInputStatus($(input),true)
//         return true
//     } else{
//         setInputStatus($(input),false)
//         return false
//     }
// }
//
// function setInputStatus(input,isValid) {
//     if(isValid){
//         $(input).removeClass("input--error")
//     }else {
//         $(input).addClass("input--error")
//     }
// }
//
//
// $(".catalog__radio input").change(function () {
//     $(".catalog__detail").slideDown()
// })


$(".catalog-gallery__open").click(function () {
    let galleryImg = document.querySelector(".catalog-gallery .swiper-slide:nth-child(1) .catalog-gallery__img")
    console.log(galleryImg)
    galleryImg.click()
})

animateFooter()
$(window).scroll(function() {
    animateFooter()
});


function animateFooter() {
    $(".footer").each(function(index, el) {
        let wt = $(window).scrollTop();
        let wh = $(window).height();
        let et = $(el).offset().top;
        let eh = $(el).outerHeight();
        let dh = $(document).height();
        if (wt + wh - 10 >= et || wh + wt - 10 == dh || eh + et + 10 < wh) {
            $(".page").addClass("unsetFixed-footer")
        } else{
            $(".page").removeClass("unsetFixed-footer")
        }
    });
}



let reviewCutCount = 3
if(window.innerWidth > 992){
    reviewCutCount = 3
} else{
    reviewCutCount = 6
}


setCutReview()

$(window).resize(function () {
    if(window.innerWidth > 992){
        reviewCutCount = 3
    } else{
        reviewCutCount = 6
    }
    setCutReview()
})

function getReviewTextHeight(){
    let letterHeight = $(".review-card__desc").css("lineHeight").slice(0, -2)
    return +letterHeight * reviewCutCount
}

function cutReviewText(el){
    $(el).css("-webkit-line-clamp",`${reviewCutCount}`)
}


$(".review-card__all").click(function () {
    if($(this).parents(".review-card").hasClass("_show")){
        $(this).parents(".review-card").removeClass("_show")
    } else{
        $(this).parents(".review-card").addClass("_show")
    }
})


function setCutReview() {
    $(".review-card__desc").each(function (index, el){
        let textHeight = $(el).height()
        if(textHeight > getReviewTextHeight()){
            cutReviewText($(el))
            $(el).parents(".review-card").addClass("_cut")
        } else{
            $(el).css("-webkit-line-clamp","unset")
            $(el).parents(".review-card").removeClass("_cut")
        }
    });
}


$(".review-form .rating__item").click(function () {
    let ratingItem = parseInt($(this).attr("data-rating-value"))
    console.log(ratingItem)

    $(this).parents(".review-form__item").find(".review-form__item-num").html(`${ratingItem}.0`)
})

$(".achieve").click(function () {
    $(this).toggleClass("_active")
})


$(document).mouseup(function(e) {
    var div = $('.achieve');
    if (!div.is(e.target) && div.has(e.target).length === 0) {
        $(".achieve").removeClass("_active")
    }
});

let stepsCount = $(".step").length

function setProgress(){
    let activeSlide = +$(".step._active").attr("data-step")
    let progress = activeSlide/stepsCount
    $(".quiz-progress__fill").css("width",`${progress*100}%`)

    if(activeSlide === 1){
        $("._prev-quiz").addClass("_disable")
    }else{
        $("._prev-quiz").removeClass("_disable")
    }

    if(activeSlide === stepsCount && activeSlide !== 1){
        $("._next-quiz").addClass("_disable")
        $("._prev-quiz").addClass("_disable")
    } else{
        $("._next-quiz").removeClass("_disable")
        $("._prev-quiz").removeClass("_disable")
    }
}

function setActiveStep(step){
    $(`.step`).removeClass("_active")
    $(`.step[data-step="${step}"]`).addClass("_active")
    setProgress()
}

$("._prev-quiz").click(function () {
    let activeSlide = +$(".step._active").attr("data-step") - 1
    if(activeSlide >= 1){
        setActiveStep(activeSlide)
    }
})

$("._next-quiz").click(function () {
    let activeSlide = +$(".step._active").attr("data-step") + 1
    if(activeSlide <= stepsCount){
        setActiveStep(activeSlide)
    }
})


setProgress()

$(".upload-step").click(function () {
    let uploadStep = +$(this).attr("data-upload")
    if(uploadStep<3){
        $(".upload-step").removeClass("_active")
        $(`.upload-step[data-upload="${uploadStep+1}"]`).addClass("_active")
    }
})

$(".flat-card__more-toggle").click(function () {
    $(this).parents(".flat-card__more").addClass("_active")
})

$(document).mouseup(function(e) {
    var div = $('.flat-card__dropdown');
    if (!div.is(e.target) && div.has(e.target).length === 0) {
        if($(div).parents(".flat-card__more").hasClass("_active")){
            $(div).parents(".flat-card__more").removeClass("_active")
        }
    }
});

$(".quiz-question__comment textarea").each(function (i,el) {
    setTextareaCount($(el))
})

$(".quiz-question__comment textarea").on("input",function () {
    setTextareaCount($(this))
})

function setTextareaCount(el) {
    let max = +$(el).attr("maxlength")
    let currentLength = $(el).val().length

    $(el).siblings(".quiz-question__comment-count").html(`${currentLength}/${max}`)
}

$(".price-calc__plus").click(function () {
    let input = $(this).siblings("input")
    let inputVal = $(input).val()
    inputVal = +inputVal.substring(0, inputVal.length - 1).trim();
    setPrice($(input),inputVal+1)
})

$(".price-calc__minus").click(function () {
    let input = $(this).siblings("input")
    let inputVal = $(input).val()
    inputVal = +inputVal.substring(0, inputVal.length - 1).trim();
    if(inputVal>0){
        setPrice($(input),inputVal-1)
    }
})

function setPrice(input,value) {
    $(input).val(`${value} P`)
}

function statChart() {
    var options = {
        series: [
            {
                name: "stat1",
                data: [100000,120000,90000,200000,300000,250000,150000]
            },
            {
                name: "stat2",
                data: [80000,170000,290000,100000,30000,150000,100000]
            }
        ],
        colors: ['#2D77E8', '#FF4D00'],
        chart: {
            height: 350,
            type: 'line',
            zoom: {
                enabled: false
            }
        },
        dataLabels: {
            enabled: false
        },
        stroke: {
            curve: 'straight'
        },
        title: {
            text: '',
            align: 'left'
        },
        grid: {
            row: {
                colors: ['transparent', 'transparent'], // takes an array which will be repeated on columns
                opacity: 0.5
            },
        },
        xaxis: {
            categories: ['22 сент.', '23 сент.', '24 сент.', '25 сент.', '26 сент.', '27 сент.', '28 сент.'],
        }
    };

    let chart = new ApexCharts(document.querySelector("#chart"), options);
    chart.render();
}
if(document.querySelector("#chart")){
    statChart()
}



$(".m-table").each(function (i,el) {
    let rowsCount = $(el).find("tbody tr").length
    if(rowsCount%2 !== 0){
        $(el).find("tfoot").addClass("_transparent")
    } else{
        $(el).find("tfoot").removeClass("_transparent")
    }
})

$("[data-modal]").click(function () {
    let modalId = $(this).attr("data-modal")

    openModal(modalId)
})

function openModal(modalId){
    $(`#${modalId}`).addClass("modal--active")
    $("body").addClass("fixed-body")
}

$(".modal__bg").click(function () {
    closeModal()
})

$(".modal__close").click(function () {
    closeModal()
})

function closeModal() {
    $('.modal').removeClass("modal--active")
    $("body").removeClass("fixed-body")
}

$(".test-nav__toggle").click(function () {
    $(".test-nav").toggleClass("_active")
})


$(".test-nav .m-btn").click(function () {
    $(".test-nav").removeClass("_active")
})

//# sourceMappingURL=../sourcemaps/main.min.js.map
